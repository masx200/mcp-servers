# MCP Bilibili Server

ä¸€ä¸ªåŸºäº MCP (Model Context Protocol)
çš„Bç«™å¼€æ”¾å¹³å°é›†æˆæœåŠ¡ï¼Œæ”¯æŒç”¨æˆ·è®¤è¯ã€è§†é¢‘ç®¡ç†ã€å®Œæ•´çš„è§†é¢‘æŠ•ç¨¿æµç¨‹ç­‰åŠŸèƒ½ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### ğŸ” ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

- **æœ¬åœ°Tokenç¼“å­˜**: è‡ªåŠ¨ç¼“å­˜è®¿é—®ä»¤ç‰Œï¼Œé¿å…é¢‘ç¹æˆæƒ
- **OAuth 2.0å®‰å…¨è®¤è¯**: é‡‡ç”¨Bç«™å®˜æ–¹æˆæƒæœºåˆ¶
- **æ‰«ç å¿«é€Ÿæˆæƒ**: è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œæ‰‹æœºæ‰«ç å³å¯å®Œæˆæˆæƒ

### ğŸ“Š ç”¨æˆ·ä¿¡æ¯ç®¡ç†

- **åŸºç¡€ä¿¡æ¯æŸ¥è¯¢**: è·å–ç”¨æˆ·æ˜µç§°ã€å¤´åƒã€openidç­‰
- **ç»Ÿè®¡æ•°æ®è·å–**: å…³æ³¨æ•°ã€ç²‰ä¸æ•°ã€æŠ•ç¨¿æ•°ç­‰ç»´åº¦æ•°æ®
- **æŠ•ç¨¿å†å²æŸ¥è¯¢**: æŸ¥çœ‹å·²å‘å¸ƒçš„è§†é¢‘åˆ—è¡¨åŠè¯¦ç»†ä¿¡æ¯

### ğŸ¬ å®Œæ•´æŠ•ç¨¿æµç¨‹

- **è§†é¢‘åˆ†åŒºæŸ¥è¯¢**: è·å–æ‰€æœ‰å¯ç”¨çš„æŠ•ç¨¿åˆ†åŒº
- **è§†é¢‘ä¸Šä¼ é¢„å¤„ç†**: è·å–ä¸Šä¼ å‚æ•°å’Œtoken
- **è§†é¢‘åˆ†ç‰‡ä¸Šä¼ **: æ”¯æŒå¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ 
- **è§†é¢‘åˆ†ç‰‡åˆå¹¶**: å®Œæˆåˆ†ç‰‡æ–‡ä»¶åˆå¹¶
- **å°é¢å›¾ç‰‡ä¸Šä¼ **: æ”¯æŒJPEGã€PNGæ ¼å¼å°é¢
- **ç¨¿ä»¶æŠ•ç¨¿æäº¤**: å®Œæˆè§†é¢‘å‘å¸ƒåˆ°Bç«™

## ğŸ“¦ å®‰è£…é…ç½®

### æ–¹å¼ä¸€ï¼šNPX ç›´æ¥è¿è¡Œï¼ˆæ¨èï¼‰

```bash
# å¦‚æœé‡åˆ°æ¨¡å—ä¾èµ–é—®é¢˜ï¼Œå¯ä»¥å…ˆæœ¬åœ°å®‰è£…
npm install -g @mcpcn/mcp-bilibili

# ç„¶åç›´æ¥è¿è¡Œ
mcp-bilibili
```

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/mcpcn/mcp-servers
cd mcp-servers/typescript/mcp-bilibili

# å®‰è£…ä¾èµ–
npm install

# æ„å»ºé¡¹ç›®
npm run build

# è¿è¡Œ
npm start
```

### æ–¹å¼ä¸‰ï¼šMCP å®¢æˆ·ç«¯é…ç½®

åœ¨ä½ çš„ MCP å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "bilibili": {
      "command": "npx",
      "args": ["@mcpcn/mcp-bilibili"]
    }
  }
}
```

æˆ–è€…ä½¿ç”¨æœ¬åœ°å®‰è£…ï¼š

```json
{
  "mcpServers": {
    "bilibili": {
      "command": "mcp-bilibili"
    }
  }
}
```

## ğŸ¯ å®Œæ•´ä½¿ç”¨æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·è®¤è¯

```bash
# 1. æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰æœ‰æ•ˆtoken
bilibili_check_local_token

# 2. å¦‚æœæ²¡æœ‰ï¼Œç”Ÿæˆæˆæƒé“¾æ¥ï¼ˆä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼‰
bilibili_web_authorize_link

# 3. æ‰«ç æˆæƒåï¼Œè·å–è®¿é—®ä»¤ç‰Œ
bilibili_web_poll_and_token --state "è¿”å›çš„stateå€¼"
```

> âš ï¸ **é‡è¦æé†’**ï¼šæˆæƒæ—¶è¯·ç¡®ä¿å‹¾é€‰æ‰€æœ‰æƒé™é¡¹ç›®ï¼š
>
> - ğŸ“± åŸºç¡€ä¿¡æ¯
> - ğŸ“Š æŠ•ç¨¿æ•ˆæœç®¡ç†
> - ğŸ¬ UPä¸»è§†é¢‘ç¨¿ä»¶ç®¡ç†
> - ğŸ“ˆ è§†é¢‘ç¨¿ä»¶æ•°æ®ç®¡ç†

### ç¬¬äºŒæ­¥ï¼šæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯

```bash
# è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
bilibili_get_user_info --access_token "ä½ çš„token"

# è·å–ç”¨æˆ·ç»Ÿè®¡æ•°æ®
bilibili_get_user_stat --access_token "ä½ çš„token"

# æŸ¥çœ‹æŠ•ç¨¿å†å²
bilibili_get_video_list --access_token "ä½ çš„token"
```

### ç¬¬ä¸‰æ­¥ï¼šè§†é¢‘æŠ•ç¨¿æµç¨‹

```bash
# 1. è·å–å¯ç”¨åˆ†åŒºåˆ—è¡¨
bilibili_get_video_categories --access_token "ä½ çš„token"

# 2. è§†é¢‘ä¸Šä¼ é¢„å¤„ç†
bilibili_upload_video_preprocess --access_token "ä½ çš„token" --filename "video.mp4"

# 3. ä¸Šä¼ è§†é¢‘åˆ†ç‰‡ï¼ˆæ”¯æŒå¤§æ–‡ä»¶ï¼‰
bilibili_upload_video_chunk --upload_token "é¢„å¤„ç†è¿”å›çš„token" --video_file_path "/path/to/video.mp4"

# 4. å®Œæˆè§†é¢‘åˆ†ç‰‡åˆå¹¶
bilibili_complete_video_upload --upload_token "é¢„å¤„ç†è¿”å›çš„token"

# 5. ä¸Šä¼ å°é¢å›¾ç‰‡
bilibili_upload_cover --access_token "ä½ çš„token" --cover_file_path "/path/to/cover.jpg"

# 6. æäº¤ç¨¿ä»¶å®ŒæˆæŠ•ç¨¿
bilibili_submit_archive --access_token "ä½ çš„token" --upload_token "é¢„å¤„ç†è¿”å›çš„token" --title "è§†é¢‘æ ‡é¢˜" --tag "æ ‡ç­¾1,æ ‡ç­¾2" --tid åˆ†åŒºID --cover "å°é¢URL"
```

## ğŸ› ï¸ API å·¥å…·è¯¦ç»†è¯´æ˜

### è®¤è¯ç›¸å…³

#### `bilibili_check_local_token`

æ£€æŸ¥æœ¬åœ°ç¼“å­˜çš„è®¿é—®ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ

**å‚æ•°**: æ— 

**è¿”å›**:

```json
{
  "hasValidToken": true,
  "access_token": "æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œ",
  "refresh_token": "åˆ·æ–°ä»¤ç‰Œ",
  "expires_at": 1640995200,
  "message": "Tokenæœ‰æ•ˆ"
}
```

#### `bilibili_web_authorize_link`

ç”ŸæˆBç«™æˆæƒé“¾æ¥å¹¶è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨

**å‚æ•°**: æ— 

**è¿”å›**:

```json
{
  "state": "unique_state_id",
  "authorize_url": "https://passport.bilibili.com/oauth2/authorize?...",
  "tips": "å·²è‡ªåŠ¨åœ¨æœ¬åœ°æµè§ˆå™¨æ‰“å¼€æˆæƒé“¾æ¥ï¼Œè¯·æ‰«ç æˆæƒ"
}
```

#### `bilibili_web_poll_and_token`

è½®è¯¢è·å–æˆæƒç å¹¶æ¢å–è®¿é—®ä»¤ç‰Œ

**å‚æ•°**:

- `state`: æˆæƒæ—¶ç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†

**è¿”å›**:

```json
{
  "access_token": "è®¿é—®ä»¤ç‰Œ",
  "refresh_token": "åˆ·æ–°ä»¤ç‰Œ",
  "expires_in": 2592000
}
```

### ç”¨æˆ·ä¿¡æ¯

#### `bilibili_get_user_info`

è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ

**è¿”å›**:

```json
{
  "name": "ç”¨æˆ·æ˜µç§°",
  "face": "å¤´åƒURL",
  "openid": "ç”¨æˆ·å”¯ä¸€æ ‡è¯†"
}
```

#### `bilibili_get_user_stat`

è·å–ç”¨æˆ·ç»Ÿè®¡æ•°æ®

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ

**è¿”å›**:

```json
{
  "following": 123,
  "follower": 456,
  "arc_passed_total": 78
}
```

#### `bilibili_get_video_list`

è·å–ç”¨æˆ·æŠ•ç¨¿è§†é¢‘åˆ—è¡¨

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ

**è¿”å›**: åŒ…å«è§†é¢‘IDã€æ ‡é¢˜ã€å°é¢ã€åˆ†åŒºã€çŠ¶æ€ç­‰ä¿¡æ¯çš„æ•°ç»„

### è§†é¢‘æŠ•ç¨¿

#### `bilibili_get_video_categories`

è·å–Bç«™è§†é¢‘åˆ†åŒºåˆ—è¡¨

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ

**è¿”å›**:

```json
[
  {
    "id": 188,
    "parent": 3,
    "name": "ç§‘æŠ€",
    "desc": "ç§‘æŠ€åˆ†åŒºæè¿°"
  }
]
```

#### `bilibili_upload_video_preprocess`

è§†é¢‘ä¸Šä¼ é¢„å¤„ç†ï¼Œè·å–ä¸Šä¼ å‚æ•°

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ
- `filename`: è§†é¢‘æ–‡ä»¶å

**è¿”å›**:

```json
{
  "upload_token": "ä¸Šä¼ ä»¤ç‰Œ"
}
```

#### `bilibili_upload_video_chunk`

ä¸Šä¼ è§†é¢‘æ–‡ä»¶åˆ†ç‰‡

**å‚æ•°**:

- `upload_token`: ä¸Šä¼ ä»¤ç‰Œ
- `video_file_path`: æœ¬åœ°è§†é¢‘æ–‡ä»¶è·¯å¾„
- `part_number`: åˆ†ç‰‡ç¼–å·ï¼ˆå¯é€‰ï¼Œé»˜è®¤1ï¼‰

**è¿”å›**:

```json
{
  "success": true,
  "message": "åˆ†ç‰‡ä¸Šä¼ æˆåŠŸ"
}
```

#### `bilibili_complete_video_upload`

å®Œæˆè§†é¢‘åˆ†ç‰‡åˆå¹¶

**å‚æ•°**:

- `upload_token`: ä¸Šä¼ ä»¤ç‰Œ

**è¿”å›**:

```json
{
  "success": true,
  "message": "è§†é¢‘åˆå¹¶æˆåŠŸ"
}
```

#### `bilibili_upload_cover`

ä¸Šä¼ è§†é¢‘å°é¢

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ
- `cover_file_path`: æœ¬åœ°å°é¢å›¾ç‰‡è·¯å¾„

**è¿”å›**:

```json
{
  "url": "https://archive.biliimg.com/bfs/archive/xxx.jpg"
}
```

#### `bilibili_submit_archive`

æäº¤è§†é¢‘ç¨¿ä»¶

**å‚æ•°**:

- `access_token`: è®¿é—®ä»¤ç‰Œ
- `upload_token`: ä¸Šä¼ ä»¤ç‰Œ
- `title`: è§†é¢‘æ ‡é¢˜ï¼ˆé•¿åº¦<80ï¼‰
- `tag`: è§†é¢‘æ ‡ç­¾ï¼ˆå¤šä¸ªç”¨è‹±æ–‡é€—å·åˆ†éš”ï¼Œæ€»é•¿åº¦<200ï¼‰
- `tid`: åˆ†åŒºID
- `desc`: è§†é¢‘æè¿°ï¼ˆå¯é€‰ï¼Œé•¿åº¦<250ï¼‰
- `cover`: å°é¢URLï¼ˆå¯é€‰ä½†å»ºè®®æä¾›ï¼‰
- `copyright`: ç‰ˆæƒç±»å‹ï¼ˆå¯é€‰ï¼Œ1-åŸåˆ›ï¼Œ2-è½¬è½½ï¼Œé»˜è®¤1ï¼‰
- `no_reprint`: ç¦æ­¢è½¬è½½ï¼ˆå¯é€‰ï¼Œ0-å…è®¸ï¼Œ1-ç¦æ­¢ï¼Œé»˜è®¤0ï¼‰
- `source`: è½¬è½½æ¥æºï¼ˆcopyright=2æ—¶å¿…å¡«ï¼‰

**è¿”å›**:

```json
{
  "resource_id": "BV1abc123def"
}
```

## ğŸ“‹ ä½¿ç”¨é™åˆ¶

### æ–‡ä»¶è¦æ±‚

- **è§†é¢‘æ–‡ä»¶**: â‰¤4GBï¼Œæ—¶é•¿â‰¤5å°æ—¶
- **å°é¢å›¾ç‰‡**: JPEG/PNGæ ¼å¼ï¼Œâ‰¤5MB
- **æ ‡é¢˜**: é•¿åº¦<80å­—ç¬¦ï¼ŒçŸ­æ—¶é—´å†…ä¸èƒ½é‡å¤
- **æè¿°**: é•¿åº¦<250å­—ç¬¦
- **æ ‡ç­¾**: æ€»é•¿åº¦<200å­—ç¬¦

### æŠ•ç¨¿é™åˆ¶

- **éæ­£å¼ä¼šå‘˜**: å•æ—¥æœ€å¤š5ä¸ªç¨¿ä»¶
- **å®¡æ ¸æ—¶é—´**: å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ä¸ç­‰
- **æƒé™è¦æ±‚**: éœ€è¦æˆæƒæ‰€æœ‰4ä¸ªæƒé™é¡¹ç›®

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
mcp-bilibili/
â”œâ”€â”€ index.ts          # MCPæœåŠ¡å™¨ä¸»ç¨‹åº
â”œâ”€â”€ oauth.ts          # OAuthè®¤è¯åŠŸèƒ½
â”œâ”€â”€ user.ts           # ç”¨æˆ·ä¿¡æ¯API
â”œâ”€â”€ video.ts          # è§†é¢‘ç®¡ç†å’ŒæŠ•ç¨¿API
â”œâ”€â”€ package.json      # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tsconfig.json     # TypeScripté…ç½®
â””â”€â”€ README.md         # ä½¿ç”¨æ–‡æ¡£
```

## ğŸ” å®‰å…¨è¯´æ˜

æœ¬å·¥å…·é‡‡ç”¨Bç«™å®˜æ–¹OAuth 2.0æˆæƒæœºåˆ¶ï¼š

- âœ… **ç”¨æˆ·æ•°æ®å®‰å…¨**: æ•°æ®å®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶ï¼Œåº”ç”¨æ— æ³•è·å–å¯†ç 
- âœ… **æƒé™å¯æ§**: ç”¨æˆ·å¯é€‰æ‹©æˆæƒå“ªäº›æƒé™
- âœ… **æ ‡å‡†åè®®**: éµå¾ªOAuth 2.0å›½é™…æ ‡å‡†
- âœ… **Tokenç¼“å­˜**: æœ¬åœ°å®‰å…¨å­˜å‚¨ï¼Œé¿å…é¢‘ç¹æˆæƒ

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Bç«™å¼€æ”¾å¹³å°æ–‡æ¡£](https://open.bilibili.com/doc/)
- [MCP (Model Context Protocol)](https://modelcontextprotocol.io/)
- [OAuth 2.0 RFC](https://tools.ietf.org/html/rfc6749)

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

---

**æ³¨æ„**: ä½¿ç”¨æœ¬å·¥å…·éœ€è¦éµå®ˆBç«™å¼€æ”¾å¹³å°çš„ä½¿ç”¨æ¡æ¬¾å’Œç¤¾åŒºè§„èŒƒã€‚

## ğŸ”§ æ•…éšœæ’é™¤

### NPX æ¨¡å—ä¾èµ–é”™è¯¯

å¦‚æœä½¿ç”¨ `npx @mcpcn/mcp-bilibili` æ—¶é‡åˆ°æ¨¡å—æ‰¾ä¸åˆ°çš„é”™è¯¯ï¼š

1. **æ¸…ç†NPXç¼“å­˜**ï¼š

```bash
npx clear-npx-cache
```

2. **å…¨å±€å®‰è£…**ï¼ˆæ¨èï¼‰ï¼š

```bash
npm install -g @mcpcn/mcp-bilibili
mcp-bilibili
```

3. **æœ¬åœ°å¼€å‘å®‰è£…**ï¼š

```bash
git clone https://github.com/mcpcn/mcp-servers
cd mcp-servers/typescript/mcp-bilibili
npm install && npm run build && npm start
```

### Node.js ç‰ˆæœ¬è¦æ±‚

ç¡®ä¿æ‚¨çš„ Node.js ç‰ˆæœ¬ >= 18.0.0ï¼š

```bash
node --version
```
